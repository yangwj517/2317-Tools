<UserControl x:Class="BatchStats.BatchStatsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:BatchStats"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="800">
    <!-- 资源定义：样式+日志颜色转换器 -->
    <UserControl.Resources>
        <!-- 段落标题样式 -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="SteelBlue"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>

        <!-- 标签样式 -->
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="5"/>
        </Style>

        <!-- 下拉框样式 -->
        <Style x:Key="ComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="MinWidth" Value="120"/>
        </Style>

        <!-- 文本框样式 -->
        <Style x:Key="TextBoxStyle" TargetType="TextBox">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="MinWidth" Value="120"/>
        </Style>

        <!-- 按钮样式 -->
        <Style x:Key="ButtonStyle" TargetType="Button">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="MinWidth" Value="80"/>
        </Style>

        <!-- 复选框样式 -->
        <Style x:Key="CheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- 日志颜色转换器（关联C#代码中的转换器类） -->
        <local:LogTypeToColorConverter x:Key="LogTypeToColorConverter" />
    </UserControl.Resources>

    <!-- 主网格布局 -->
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- 标题行 -->
            <RowDefinition Height="Auto"/>
            <!-- 地址配置行 -->
            <RowDefinition Height="Auto"/>
            <!-- 生成操作行 -->
            <RowDefinition Height="*"/>
            <!-- 日志区域行（占满剩余空间） -->
        </Grid.RowDefinitions>

        <!-- 1. 标题 -->
        <TextBlock 
            Grid.Row="0" 
            Text="BatchStats - Stats文件转XLSX工具" 
            FontSize="18" 
            FontWeight="Bold" 
            Foreground="DarkBlue" 
            Margin="0,0,0,20"/>

        <!-- 2. 地址配置区域（Stats文件路径选择） -->
        <GroupBox 
            Grid.Row="1" 
            Header="1. 地址配置" 
            Padding="10"
            Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <!-- 标签列 -->
                    <ColumnDefinition Width="*"/>
                    <!-- 文本框列（自适应宽度） -->
                    <ColumnDefinition Width="Auto"/>
                    <!-- 按钮列 -->
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <!-- 仅1行 -->
                </Grid.RowDefinitions>

                <!-- 路径标签 -->
                <TextBlock 
                    Grid.Row="0" 
                    Grid.Column="0" 
                    Text="Stats文件路径:" 
                    Style="{StaticResource LabelStyle}"
                    MinWidth="100"/>

                <!-- 路径文本框（与C#代码变量对应） -->
                <TextBox 
                    Grid.Row="0" 
                    Grid.Column="1" 
                    x:Name="FlordPathTextBox" 
                    Style="{StaticResource TextBoxStyle}"
                    IsReadOnly="True"
                    MinWidth="300"/>

                <!-- 选择文件夹按钮（绑定C#点击事件） -->
                <Button 
                    Grid.Row="0" 
                    Grid.Column="2" 
                    Content="选择文件夹" 
                    Click="SelectFlord_Click" 
                    Style="{StaticResource ButtonStyle}"
                    Background="LightSkyBlue"
                    Foreground="Black"/>
            </Grid>
        </GroupBox>

        <!-- 3. 生成操作区域 -->
        <GroupBox 
            Grid.Row="2" 
            Header="2. 生成操作" 
            Padding="10"
            Margin="0,0,0,10">
            <StackPanel 
                Orientation="Horizontal" 
                HorizontalAlignment="Center"
                Margin="0,5,0,5">

                <!-- 生成XLSX按钮（绑定C#点击事件） -->
                <Button 
                    Content="生成XLSX" 
                    Click="GenerateXlsx_Click" 
                    Style="{StaticResource ButtonStyle}"
                    Background="LightGreen"
                    Foreground="Black"
                    Margin="0,0,15,0"/>

                <!-- 清空按钮（绑定C#点击事件） -->
                <Button 
                    Content="清空" 
                    Click="Clear_Click" 
                    Style="{StaticResource ButtonStyle}"
                    Background="LightCoral"
                    Foreground="Black"/>
            </StackPanel>
        </GroupBox>

        <!-- 4. 日志显示区域 -->
        <GroupBox 
            Grid.Row="3" 
            Header="3. 执行日志" 
            Padding="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <!-- 日志列表占满区域 -->
                </Grid.RowDefinitions>

                <!-- 日志边框容器 -->
                <Border 
                    Grid.Row="0" 
                    BorderThickness="1" 
                    BorderBrush="LightGray" 
                    CornerRadius="3"
                    Background="White">

                    <!-- 日志列表（与C#代码变量对应） -->
                    <ListBox 
                        x:Name="LogListBox" 
                        HorizontalContentAlignment="Stretch"
                        ScrollViewer.HorizontalScrollBarVisibility="Auto"
                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                        BorderThickness="0">

                        <!-- 日志项模板（颜色区分+自动换行） -->
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock 
                                    Text="{Binding}" 
                                    TextWrapping="Wrap"
                                    Margin="5,2" 
                                    FontFamily="Consolas"
                                    FontSize="12"
                                    Foreground="{Binding Converter={StaticResource LogTypeToColorConverter}}"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>
            </Grid>
        </GroupBox>
    </Grid>
</UserControl>
    